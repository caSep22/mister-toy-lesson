import{r as m,o as a,c,a as s,b as y,w as h,d as k,F as w,e as f,t as p,f as R,g as b,h as v,v as $,i as U,j as N,k as D,l as L,m as P,n as F,p as J,q as H,s as M}from"./vendor.bebf99b6.js";const j=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}};j();var q="/assets/02_rubber_duck.f77ab927.png",_=(t,e)=>{const n=t.__vccOpts||t;for(const[i,o]of e)n[i]=o;return n};const G={name:"app-header",methods:{goHome(){this.$router.push("/").catch(()=>{})},logout(){this.$store.dispatch("logout")}},computed:{user(){return this.$store.getters.getUser}}},W={class:"header-container"},K={class:"main-app-header flex space-between align-center container"},X=s("div",{class:"logo-img"},[s("img",{src:q,alt:"Rubber Duck"})],-1),Y=s("h1",null,"Toys",-1),z=[X,Y],Q={class:"nav-bar-container"},Z=f("Home"),ee=f("Dashboard"),te=f("About Us"),se=f("Reviews"),oe=f("Login"),ne=f("User");function re(t,e,n,i,o,r){const l=m("router-link");return a(),c("header",W,[s("section",K,[s("div",{onClick:e[0]||(e[0]=(...u)=>r.goHome&&r.goHome(...u)),class:"logo flex align-end"},z),s("div",Q,[y(l,{to:"/",class:"nav-bar-link"},{default:h(()=>[Z]),_:1}),y(l,{to:"/dashboard",class:"nav-bar-link"},{default:h(()=>[ee]),_:1}),y(l,{to:"/about",class:"nav-bar-link"},{default:h(()=>[te]),_:1}),y(l,{to:"/review",class:"nav-bar-link"},{default:h(()=>[se]),_:1}),r.user?(a(),c(w,{key:1},[y(l,{to:"/User",class:"nav-bar-link"},{default:h(()=>[ne]),_:1}),s("button",{onClick:e[1]||(e[1]=(...u)=>r.logout&&r.logout(...u)),class:"nav-bar-link"},"Logout")],64)):(a(),k(l,{key:0,to:"/login",class:"nav-bar-link"},{default:h(()=>[oe]),_:1}))])])])}var le=_(G,[["render",re]]);const ie={components:{appHeader:le}},ae={id:"app",class:"main-layout flex column"},ce=s("footer",{class:"main-app-footer flex center-center"},[s("h5",null,"copyright")],-1);function ue(t,e,n,i,o,r){const l=m("app-header"),u=m("router-view");return a(),c("div",ae,[y(l),y(u,{class:"flex column grow-1"}),ce])}var de=_(ie,[["render",ue]]);const pe={props:{toy:Object},methods:{showToyDetails(){this.$router.push("/toy/"+this.toy._id)},toEdit(t){this.$router.push(`/toy/edit/${t}`)},removeToy(){this.$store.dispatch({type:"removeToy",toyId:this.toy._id})}}},ye={class:"toy-preview-info flex column space-between"},_e={class:"toy-preview-btns flex column space-between"};function he(t,e,n,i,o,r){return a(),c("li",{class:"toy-preview-container flex space-between",onClick:e[2]||(e[2]=(...l)=>r.showToyDetails&&r.showToyDetails(...l))},[s("div",ye,[s("div",null,[s("h3",null,p(n.toy.name),1)]),s("h4",null,p(n.toy.price),1)]),s("div",_e,[s("button",{onClick:e[0]||(e[0]=l=>r.toEdit(n.toy._id))},"Edit"),s("button",{class:"btn",onClick:e[1]||(e[1]=R((...l)=>r.removeToy&&r.removeToy(...l),["stop"]))},"X")])])}var me=_(pe,[["render",he]]);const ve={props:{toys:Array},components:{toyPreview:me},methods:{toAddToy(){this.$router.push("/toy/edit")}}},ge={class:"toy-list-container"},fe={class:"toy-list clean-list toy-list-layout"};function we(t,e,n,i,o,r){const l=m("toy-preview");return a(),c("section",ge,[s("button",{onClick:e[0]||(e[0]=u=>r.toAddToy())},"Add Toy"),s("ul",fe,[(a(!0),c(w,null,b(n.toys,u=>(a(),k(l,{key:u._id,toy:u},null,8,["toy"]))),128))])])}var $e=_(ve,[["render",we],["__scopeId","data-v-97b90420"]]);const be={data(){return{filter:{name:"",inStock:"All",type:"All"},sortBy:"",typeOptions:[{value:"All",label:"all"},{value:"Educational",label:"edu"},{value:"Funny",label:"funny"},{value:"Adult",label:"adult"}],sortOptions:[{value:"name",label:"name"},{value:"price",label:"price"}],stockOptions:[{value:"All",label:"all"},{value:!0,label:"inStock"},{value:!1,label:"outStock"}]}},methods:{setFilterBy(){var t=this.filter;console.log(t),this.$store.commit({type:"setFilterBy",filterBy:JSON.parse(JSON.stringify(t))}),this.$store.dispatch("loadToys")},setSortBy(){this.$store.commit({type:"sortBy",sortBy:JSON.parse(JSON.stringify(this.sortBy))})}}},Te={class:"main-filter-container flex space-between"},ke={class:"filter-container flex align-end"},xe=s("h4",null,"name",-1),Se=s("h4",null,"type",-1),Ue=s("h4",null,"stock",-1),Re={class:"sort-container flex align-end"},Be=s("h4",null,"sort",-1);function Ie(t,e,n,i,o,r){const l=m("el-input"),u=m("el-option"),I=m("el-select");return a(),c("div",Te,[s("div",ke,[s("label",null,[xe,y(l,{type:"text",placeholder:"search",modelValue:o.filter.name,"onUpdate:modelValue":e[0]||(e[0]=d=>o.filter.name=d),onInput:r.setFilterBy},null,8,["modelValue","onInput"])]),s("label",null,[Se,y(I,{onChange:r.setFilterBy,modelValue:o.filter.type,"onUpdate:modelValue":e[1]||(e[1]=d=>o.filter.type=d)},{default:h(()=>[(a(!0),c(w,null,b(o.typeOptions,d=>(a(),k(u,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),s("label",null,[Ue,y(I,{onChange:r.setFilterBy,modelValue:o.filter.inStock,"onUpdate:modelValue":e[2]||(e[2]=d=>o.filter.inStock=d)},{default:h(()=>[(a(!0),c(w,null,b(o.stockOptions,d=>(a(),k(u,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])])]),s("div",Re,[s("label",null,[Be,y(I,{modelValue:o.sortBy,"onUpdate:modelValue":e[3]||(e[3]=d=>o.sortBy=d),onChange:r.setSortBy,placeholder:""},{default:h(()=>[(a(!0),c(w,null,b(o.sortOptions,d=>(a(),k(u,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])])])}var Oe=_(be,[["render",Ie]]);const Ae={created(){this.$store.dispatch("loadToys")},computed:{toys(){return this.$store.getters.getToys}},components:{toyList:$e,toyFilter:Oe}},Ee={class:"toy-app-container container"};function Ne(t,e,n,i,o,r){const l=m("toy-filter"),u=m("toy-list");return a(),c("section",Ee,[y(l),y(u,{toys:r.toys},null,8,["toys"])])}var Ve=_(Ae,[["render",Ne]]);const Ce={data(){return{toy:null,review:""}},computed:{toyInStock(){return this.toy.inStock?"Toy is in stock":"Toy is not available in stock"},date(){return new Date(this.toy.createdAt).toLocaleDateString()},reviews(){return this.$store.getters.getReviews}},created(){var t=this.$route.params.id;this.getToyById(t),this.getReviews(t)},methods:{async getToyById(t){this.toy=await this.$store.dispatch({type:"getToyById",toyId:t})},async getReviews(t){await this.$store.dispatch({type:"getReviews",filterBy:{toyId:t}})},async addReview(){await this.$store.dispatch({type:"addReview",toyId:this.toy._id,content:this.review}),this.review="",this.getReviews(this.toy._id)}}},De={key:0,class:"toy-detailes-container container"},Le={class:"toy-details flex align-center"},Pe={class:"toy-info"},Fe={class:"img-container"},Je=["src"],He={key:1,src:"https://www.pulsecarshalton.co.uk/wp-content/uploads/2016/08/jk-placeholder-image.jpg",alt:"image placeholder"},Me={class:"review-container"},je={class:"review-add flex"},qe={key:0,class:"review-list"},Ge=s("summary",null,"Reviews",-1);function We(t,e,n,i,o,r){return o.toy?(a(),c("div",De,[s("div",Le,[s("div",Pe,[s("h2",null,p(o.toy.name),1),s("h3",null,"Price: $"+p(o.toy.price),1),s("h3",null,"Type: "+p(o.toy.type),1),s("h3",null,p(r.toyInStock),1),s("h4",null,"The toy was created at: "+p(r.date),1)]),s("div",Fe,[o.toy.imgUrl?(a(),c("img",{key:0,src:o.toy.imgUrl,alt:"toy-img"},null,8,Je)):(a(),c("img",He))])]),s("div",Me,[s("div",je,[v(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>o.review=l),placeholder:"Write your review"},null,512),[[$,o.review]]),s("button",{onClick:e[1]||(e[1]=(...l)=>r.addReview&&r.addReview(...l)),class:"btn"},"Save")]),r.reviews?(a(),c("details",qe,[Ge,(a(!0),c(w,null,b(r.reviews,l=>(a(),c("div",{key:l._id,class:"review-preview"},[s("h4",null,"By "+p(l.user.username),1),s("p",null,p(l.content),1)]))),128))])):U("",!0)])])):U("",!0)}var Ke=_(Ce,[["render",We]]);const Xe="/api/";var Ye=N.create({withCredentials:!0});const g={get(t,e){return S(t,"GET",e)},post(t,e){return S(t,"POST",e)},put(t,e){return S(t,"PUT",e)},delete(t,e){return S(t,"DELETE",e)}};async function S(t,e="GET",n=null){try{return(await Ye({url:`${Xe}${t}`,method:e,data:n,params:e==="GET"?n:null})).data}catch(i){throw console.log(`Had Issues ${e}ing to the backend, endpoint: ${t}, with data: ${n}`),console.dir(i),i.response&&i.response.status===401&&window.location.assign("/login"),i}}const x="toy";async function ze(t){return await g.get(x,t)}async function Qe(t){return await g.get(`${x}/${t}`)}async function Ze(t){return await g.delete(`${x}/${t}`)}async function et(e){var e=JSON.parse(JSON.stringify(e));return console.log("toy",e),e._id?await g.put(`${x}/${e._id}`,e):(console.log("saving front toy"),e.name||(e.name="Unknown"),await g.post(x,e))}function tt(){var t={name:"",price:0,type:null,inStock:!0,reviews:[]};return t}const T={getToys:ze,getToyById:Qe,getEmptyToy:tt,removeToy:Ze,saveToy:et},st=async t=>{const e="my-test",i="https://api.cloudinary.com/v1_1/rotemc/image/upload",o=new FormData;o.append("file",t),o.append("upload_preset",e);try{return(await N.post(i,o)).data}catch(r){console.error("ERROR!",r)}},ot={name:"toy-edit",data(){return{toy:null,isLoading:!1}},created(){var t=this.$route.params.id;t?this.getToyById(t):this.toy=T.getEmptyToy()},methods:{async getToyById(t){this.toy=await this.$store.dispatch({type:"getToyById",toyId:t})},async saveToy(){await this.$store.dispatch({type:"saveToy",toy:this.toy}),this.$router.push("/")},async uploadImg(t){this.isLoading=!0;const e=t.target.files[0],n=await st(e);this.toy.imgUrl=n.url,this.isLoading=!1}},components:{}},nt=s("option",{value:"Educational"},"edu",-1),rt=s("option",{value:"Funny"},"funny",-1),lt=s("option",{value:"Adult"},"adult",-1),it=[nt,rt,lt],at={class:"in-stock flex space-between align-center"},ct=f("inStock "),ut=["disabled"];function dt(t,e,n,i,o,r){return o.toy?(a(),c("form",{key:0,onSubmit:e[5]||(e[5]=R((...l)=>r.saveToy&&r.saveToy(...l),["prevent"])),class:"toy-edit-container container flex column"},[v(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>o.toy.name=l)},null,512),[[$,o.toy.name]]),v(s("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=l=>o.toy.price=l)},null,512),[[$,o.toy.price,void 0,{number:!0}]]),v(s("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.toy.type=l)},it,512),[[D,o.toy.type]]),s("label",at,[ct,v(s("input",{type:"checkbox",class:"custom-checkbox","onUpdate:modelValue":e[3]||(e[3]=l=>o.toy.inStock=l)},null,512),[[L,o.toy.inStock]])]),s("button",{disabled:t.invalid||o.isLoading,class:"btn"},"save",8,ut),s("input",{type:"file",onChange:e[4]||(e[4]=(...l)=>r.uploadImg&&r.uploadImg(...l))},null,32)],32)):U("",!0)}var pt=_(ot,[["render",dt]]);const yt={data(){return{dataReady:!1}},computed:{toys(){return this.$store.getters.getToys},inStockTypesMap(){var t;return(t=this.toys)==null?void 0:t.reduce((e,n)=>(e[n.type]||(e[n.type]=0),n.inStock&&e[n.type]++,e),{})}},async created(){try{await this.$store.dispatch("loadToys"),this.dataReady=!0}catch(t){console.log("Couldn't get toys",t)}},components:{}},_t={class:"dashboard-page-container flex"},ht=s("h1",null,"Dashboard",-1),mt=[ht];function vt(t,e,n,i,o,r){return a(),c("section",_t,mt)}var gt=_(yt,[["render",vt]]);const ft={data(){return{branches:[{city:"Petach Tikva",position:{lat:32.09573,lng:34.881865}},{city:"Tel Aviv",position:{lat:32.08704,lng:34.775293}},{city:"Netanya",position:{lat:32.290295,lng:34.861591}}],currBranch:null}},components:{}},wt={class:"about-page-container"},$t=s("h1",null,"About Us",-1),bt=s("section",{class:"branch-container flex column align-center"},null,-1),Tt=[$t,bt];function kt(t,e,n,i,o,r){return a(),c("section",wt,Tt)}var xt=_(ft,[["render",kt]]);const St={name:"login-page",data(){return{cred:{username:"",password:""}}},methods:{async login(){await this.$store.dispatch({type:"login",cred:this.cred}),this.$router.push("/")}},mounted(){this.$refs.username.focus()}},Ut={class:"login-card flex column space-between"},Rt={class:"login-fields flex column space-between grow-1"},Bt=s("h3",null,"login",-1),It=s("label",null," Username ",-1),Ot=s("label",null," Password ",-1),At=s("button",{class:"login-btn"},"login",-1),Et=f("Don't have an account yet?");function Nt(t,e,n,i,o,r){const l=m("router-link");return a(),c("form",{onSubmit:e[2]||(e[2]=R((...u)=>r.login&&r.login(...u),["prevent"])),class:"login-container form-page"},[s("div",Ut,[s("div",Rt,[Bt,It,v(s("input",{ref:"username","onUpdate:modelValue":e[0]||(e[0]=u=>o.cred.username=u),type:"text"},null,512),[[$,o.cred.username]]),Ot,v(s("input",{"onUpdate:modelValue":e[1]||(e[1]=u=>o.cred.password=u),type:"password"},null,512),[[$,o.cred.password]])]),At]),y(l,{to:"/signup",class:"sec-btn"},{default:h(()=>[Et]),_:1})],32)}var Vt=_(St,[["render",Nt]]);const Ct={name:"signup-page",data(){return{cred:{fullname:"",username:"",password:""}}},methods:{async signup(){await this.$store.dispatch({type:"signup",cred:this.cred}),this.$router.push("/")}},mounted(){this.$refs.fullname.focus()}},Dt={class:"signup-card flex column space-between"},Lt={class:"signup-fields flex column space-between grow-1"},Pt=s("h3",null,"Signup",-1),Ft=s("label",null," Full Name ",-1),Jt=s("label",null," Username ",-1),Ht=s("label",null," Password ",-1),Mt=s("button",{class:"signup-btn"},"signup",-1),jt=f("Already signed up?");function qt(t,e,n,i,o,r){const l=m("router-link");return a(),c("form",{onSubmit:e[3]||(e[3]=R((...u)=>r.signup&&r.signup(...u),["prevent"])),class:"signup-container form-page"},[s("div",Dt,[s("div",Lt,[Pt,Ft,v(s("input",{ref:"fullname","onUpdate:modelValue":e[0]||(e[0]=u=>o.cred.fullname=u),type:"text"},null,512),[[$,o.cred.fullname]]),Jt,v(s("input",{"onUpdate:modelValue":e[1]||(e[1]=u=>o.cred.username=u),type:"text"},null,512),[[$,o.cred.username]]),Ht,v(s("input",{"onUpdate:modelValue":e[2]||(e[2]=u=>o.cred.password=u),type:"password"},null,512),[[$,o.cred.password]])]),Mt]),y(l,{to:"/login",class:"sec-btn"},{default:h(()=>[jt]),_:1})],32)}var Gt=_(Ct,[["render",qt]]);const Wt={name:"user-details",computed:{user(){return this.$store.getters.getUser},reviews(){return this.$store.getters.getReviews}},created(){this.$store.dispatch({type:"getReviews",filterBy:{userId:this.user._id}})}},Kt={key:0,class:"user-details container"},Xt={key:0,class:"review-list"},Yt=s("summary",null,"Your Reviews",-1),zt={key:1};function Qt(t,e,n,i,o,r){return r.user?(a(),c("div",Kt,[s("h3",null,"Hello "+p(r.user.fullname),1),s("h3",null,"Username: "+p(r.user.username),1),r.reviews?(a(),c("details",Xt,[Yt,(a(!0),c(w,null,b(r.reviews,l=>(a(),c("div",{key:l._id,class:"review-preview"},[s("h4",null,"About: "+p(l.toy.name),1),s("p",null,"Review: "+p(l.content),1)]))),128))])):U("",!0)])):(a(),c("h3",zt,"No logged In user"))}var Zt=_(Wt,[["render",Qt]]);const es={name:"review-page",computed:{reviews(){return this.$store.getters.getReviews}},created(){this.$store.dispatch({type:"getReviews"})}},ts={class:"review-page-container"},ss=s("h1",null,"Reviews",-1);function os(t,e,n,i,o,r){return a(),c("div",ts,[ss,(a(!0),c(w,null,b(r.reviews,l=>(a(),c("div",{key:l._id,class:"review-preview flex column align-center"},[s("h4",null,"About: "+p(l.toy.name),1),s("h4",null,"By: "+p(l.user.username),1),s("p",null,"Review: "+p(l.content),1)]))),128))])}var ns=_(es,[["render",os]]);const V=P({history:F("/"),routes:[{path:"/",name:"toy-app",component:Ve},{path:"/toy/edit/:id?",name:"toy-edit",component:pt},{path:"/toy/:id",name:"toy-details",component:Ke},{path:"/login",name:"login-page",component:Vt},{path:"/signup",name:"signup-page",component:Gt},{path:"/dashboard",name:"dashboard-page",component:gt},{path:"/about",name:"about-page",component:xt},{path:"/user",name:"user-details",component:Zt},{path:"/review",name:"review-page",component:ns}]});var rs={state:{toys:null,filterBy:null},getters:{getToys(t){return t.toys}},mutations:{setToys(t,{toys:e}){t.toys=e},setFilterBy(t,{filterBy:e}){t.filterBy=e},sortBy(t,{sortBy:e}){var n=JSON.parse(JSON.stringify(t.toys));e?t.toys=n.sort((i,o)=>{let r=i[e],l=o[e];return e==="name"&&(r=r.toLowerCase(),l=l.toLowerCase()),r>l?1:-1}):t.toys=n},removeToy(t,{toyId:e}){var n=JSON.parse(JSON.stringify(t.toys)),i=n.findIndex(o=>o._id===e);n.splice(i,1),t.toys=n},addToy(t,{toy:e}){t.toys.push(e)},updateToy(t,{toy:e}){const n=t.toys.findIndex(i=>i._id===e._id);t.toys.splice(n,1,e)}},actions:{async loadToys(t){try{var e=t.state.filterBy?t.state.filterBy:"";const n=await T.getToys(e);return t.commit({type:"setToys",toys:n}),n}catch(n){console.log(n)}},async getToyById(t,{toyId:e}){try{return await T.getToyById(e)}catch(n){console.log(n)}},getEmptyToy(){return T.getEmptyToy()},async removeToy(t,{toyId:e}){try{await T.removeToy(e),t.commit({type:"removeToy",toyId:e});return}catch(n){console.log(n)}},async saveToy(t,{toy:e}){try{const n=!!e._id,i=await T.saveToy(e);t.commit({type:n?"updateToy":"addToy",toy:i})}catch(n){console.log(n)}}},modules:{}};const A="auth";async function ls(t){return await g.post(A+"/login",t)}async function is(t){return await g.post(A+"/signup",t)}async function as(){return await g.post(A+"/logout")}const O={login:ls,signup:is,logout:as};var cs={state:{loggedinUser:null},getters:{getUser(t){return t.loggedinUser}},mutations:{setUser(t,{user:e}){t.loggedinUser=e}},actions:{async login({commit:t},{cred:e}){try{const n=await O.login(e);t({type:"setUser",user:n})}catch(n){console.log(n)}},async signup({commit:t},{cred:e}){try{const n=await O.signup(e);t({type:"setUser",user:n})}catch(n){console.log(n)}},async logout({commit:t}){try{await O.logout(),t({type:"setUser",user:null})}catch(e){console.log(e)}}}};const C="review";async function us(t){return await g.get(C,t)}async function ds(t){return await g.post(C,t)}const E={query:us,addReview:ds};var ps={state:{reviews:null},getters:{getReviews(t){return t.reviews}},mutations:{setReviews(t,{reviews:e}){t.reviews=e},addReview(t,{review:e}){t.reviews.push(e)}},actions:{async getReviews({commit:t},{filterBy:e}){try{const n=await E.query(e);t({type:"setReviews",reviews:n})}catch(n){console.log(n)}},async addReview(t,{content:e,toyId:n}){const i=t.rootGetters.getUser;if(!i)return V.push("/login");const o={content:e,userId:i._id,toyId:n};await E.addReview(o)}}};const ys=J({strict:!0,state:{},modules:{toyStore:rs,userStore:cs,reviewStore:ps}});const B=H(de);B.use(V);B.use(ys);B.use(M);B.mount("#app");
